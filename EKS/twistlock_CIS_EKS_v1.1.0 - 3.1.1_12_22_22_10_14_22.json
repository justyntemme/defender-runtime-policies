{"modified":"2022-12-16T04:38:27.179Z","owner":"rsingh3@paloaltonetworks.com","name":"CIS_EKS_v1.1.0 - 3.1.1","previousName":"","_id":9016,"title":"Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive","script":"file_path=$(ps -ef | grep kubelet | grep -o '\\-\\-kubeconfig=[^ ]*' | cut -d= -f2)\r\nif [ -z $file_path ]; then\r\n  file_path=$(ps -ef | grep kubelet | grep -o '\\-\\-kubeconfig [^ ]*' | cut -d' ' -f2)\r\n  if [ -z $file_path ]; then\r\n    echo \"Config File Not Found\"\r\n    exit 1\r\n  fi\r\nfi\r\nif [ -f $file_path ]; then\r\n  perm=$(stat -c %a $file_path)\r\n  if [ $perm -eq 644 ]; then\r\n    exit 0\r\n  else\r\n    echo \"EKS CIS 3.1.1 -  Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive.\"\r\n    exit 1\r\n  fi\r\nfi\r\n","severity":"medium"}