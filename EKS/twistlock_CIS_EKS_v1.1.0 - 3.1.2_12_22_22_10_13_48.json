{"modified":"2022-12-14T11:13:48.445Z","owner":"ssharma7@paloaltonetworks.com","name":"CIS_EKS_v1.1.0 - 3.1.2","previousName":"","_id":9005,"title":"Ensure that the kubelet kubeconfig file ownership is set to root:root","script":"file_path=$(ps -ef | grep kubelet | grep -o '\\-\\-kubeconfig=[^ ]*' | cut -d= -f2)\nif [ -z $file_path ]; then\n  file_path=$(ps -ef | grep kubelet | grep -o '\\-\\-kubeconfig [^ ]*' | cut -d' ' -f2)\n  if [ -z $file_path ]; then\n    echo \"Config File Not Found\"\n    exit 1\n  fi\nfi\n\nif [ -f $file_path ]; then\n  owner=$(stat -c %U:%G $file_path)\n  if [ $owner == \"root:root\" ]; then\n    exit 0\n  else\n    echo \"EKS CIS 3.1.2 -  Ensure that the controller manager pod specification file ownership are set to root:root.\"\n    exit 1\n  fi\nfi\n\n","severity":"medium"}