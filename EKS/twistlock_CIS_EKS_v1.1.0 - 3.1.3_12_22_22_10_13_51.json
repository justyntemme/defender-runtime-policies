{"modified":"2022-12-14T11:13:52.427Z","owner":"ssharma7@paloaltonetworks.com","name":"CIS_EKS_v1.1.0 - 3.1.3","previousName":"","_id":9006,"title":"Ensure that the kubelet configuration file has permissions set to 644 or more restrictive","script":"file_path=$(ps -ef | grep kubelet | grep -o '\\-\\-config=[^ ]*' | cut -d= -f2)\nif [ -z $file_path ]; then\n  file_path=$(ps -ef | grep kubelet | grep -o '\\-\\-config [^ ]*' | cut -d' ' -f2)\n  if [ -z $file_path ]; then\n    echo \"Config File Not Found\"\n    exit 1\n  fi\nfi\n\nif [ -f $file_path ]; then\n  perm=$(stat -c %a $file_path)\n  if [ $perm -eq 644 ]; then\n  exit 0\n  else\n    echo \"EKS CIS 3.1.3 -  Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive.\"\n    exit 1\n  fi\nfi\n\n","severity":"medium"}